// --------------------------------------------------------
// Code generated by Papyrus Java
// --------------------------------------------------------

package SettlersOfCatan;

import java.util.ArrayList;
import java.util.EnumMap;
import java.util.List;
import java.util.Map;

/**
 * 
 */
public class Player {
	/**
	 * 
	 */
	private PlayerColor color;
	/**
	 * 
	 */
	protected Map<ResourceType, Integer> resources;
	/**
	 * 
	 */
	protected Map<BuildingType, Integer> buildings;

	private Settlement Settlements;
	/**
	 * 
	 */
	private City cities;
	/**
	 * 
	 */
	private Road roads;
	/**
	 * 
	 */
	private int victoryPoints;

	public Player(PlayerColor color){
		this.color = color;
		this.victoryPoints = 0;
		resources = new EnumMap<ResourceType, Integer>(ResourceType.class);
		buildings = new EnumMap<BuildingType, Integer>(BuildingType.class);
		for (int i = 0; i<ResourceType.values().length; i++){
			resources.put(ResourceType.values()[i], 0);
		}
		buildings.put(BuildingType.ROAD, 15);
		buildings.put(BuildingType.SETTLEMENT, 5);
		buildings.put(BuildingType.CITY, 4);
	}

	/**
	 * 
	 * @param res 
	 */
	public void addResource(ResourceType res) {
		if (res == ResourceType.NULL){
			return;
		}

		int current = resources.get(res);
		resources.put(res, current + 1);
	}

	/**
	 * 
	 * @param res 
	 * @return 
	 */
	public boolean removeResource(ResourceType res, int amount) {
		int current = resources.get(res);
		if ((current - amount) < 0){
			return false;
		}

		resources.put(res, current - amount);
		return true;
	}

	/**
	 * 
	 * @return 
	 */
	public boolean canBuildRoad() {
		if ((resources.get(ResourceType.WOOD)>0 && resources.get(ResourceType.BRICK)>0) && buildings.get(BuildingType.ROAD)>0) {
			return true;
		}
		return false;
	}

	/**
	 * 
	 * @return 
	 */
	public boolean canBuildSettlement() {
		if ((resources.get(ResourceType.WOOD)>0 && resources.get(ResourceType.BRICK)>0 && resources.get(ResourceType.SHEEP)>0 && resources.get(ResourceType.WHEAT)>0) && buildings.get(BuildingType.SETTLEMENT)>0) {
			return true;
		}
		return false;
	}

	/**
	 * 
	 * @return 
	 */
	public boolean canBuildCity() {
		if ((resources.get(ResourceType.ORE)>=3 && resources.get(ResourceType.WHEAT)>=2) && buildings.get(BuildingType.CITY)>0) {
			return true;
		}
		return false;
	}

	/**
	 * Pays resources and consumes a settlement piece.
	 * Does not check canBuildSettlement(); call that first.
	 * @return true if payment succeeded
	 */
	public boolean payForSettlement() {
		if (!canBuildSettlement()) {
			return false;
		}

		// Spend 1 of each: WOOD, BRICK, SHEEP, WHEAT
		removeResource(ResourceType.WOOD, 1);
		removeResource(ResourceType.BRICK, 1);
		removeResource(ResourceType.SHEEP, 1);
		removeResource(ResourceType.WHEAT, 1);

		// Consume one settlement piece
		buildings.put(
			BuildingType.SETTLEMENT,
			buildings.get(BuildingType.SETTLEMENT) - 1
		);

		// +1 victory point for a new settlement
		this.victoryPoints += 1;
		return true;
	}

	/**
	 * Pays resources and consumes a city piece, upgrading an existing settlement.
	 * Does not check canBuildCity(); call that first.
	 * @return true if payment succeeded
	 */
	public boolean payForCityUpgrade() {
		if (!canBuildCity()) {
			return false;
		}

		// Spend 3 ore and 2 wheat
		removeResource(ResourceType.ORE, 3);
		removeResource(ResourceType.WHEAT, 2);

		// Consume one city piece, effectively upgrading one settlement
		buildings.put(
			BuildingType.CITY,
			buildings.get(BuildingType.CITY) - 1
		);

		// Net +1 victory point (settlement 1 -> city 2)
		this.victoryPoints += 1;
		return true;
	}

	/**
	 * 
	 * @return 
	 */
	public int getVictoryPoints() {
		return this.victoryPoints;
	}

	/**
	 * Uses one settlement piece without paying resources (for initial setup).
	 */
	public void useSettlementPiece() {
		buildings.put(
			BuildingType.SETTLEMENT,
			buildings.get(BuildingType.SETTLEMENT) - 1
		);
	}

	/**
	 * Adds victory points to the player.
	 * @param points The number of victory points to add
	 */
	public void addVictoryPoint(int points) {
		this.victoryPoints += points;
	}
}
